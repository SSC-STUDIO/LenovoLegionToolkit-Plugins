<UserControl x:Class="LenovoLegionToolkit.Plugins.ShellIntegration.ShellIntegrationSettingsPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:wpfui="http://schemas.lepo.co/wpfui/2022/xaml"
             xmlns:utils="clr-namespace:LenovoLegionToolkit.WPF.Utils"
             xmlns:resources="clr-namespace:LenovoLegionToolkit.Plugins.ShellIntegration.Resources"
             ScrollViewer.CanContentScroll="True"
             ScrollViewer.VerticalScrollBarVisibility="Auto">

    <UserControl.Resources>
        <!-- Card Style -->
        <Style x:Key="SettingsCardStyle" TargetType="Border">
            <Setter Property="Background" Value="{DynamicResource ControlFillColorDefaultBrush}" />
            <Setter Property="BorderBrush" Value="{DynamicResource ControlStrokeColorDefaultBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="8" />
            <Setter Property="Padding" Value="20" />
            <Setter Property="Margin" Value="0,0,0,16" />
        </Style>
        
        <!-- Header Style -->
        <Style x:Key="SettingsHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16" />
            <Setter Property="FontWeight" Value="Medium" />
            <Setter Property="Foreground" Value="{DynamicResource TextFillColorPrimaryBrush}" />
            <Setter Property="Margin" Value="0,0,0,12" />
        </Style>
        
        <!-- List Item Style -->
        <Style x:Key="ListItemStyle" TargetType="Border">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderBrush" Value="{DynamicResource ControlStrokeColorDefaultBrush}" />
            <Setter Property="BorderThickness" Value="0,0,0,1" />
            <Setter Property="Padding" Value="0,12,0,12" />
        </Style>
        
        <!-- Toggle Button Style -->
        <Style x:Key="ToggleStyle" TargetType="ToggleButton">
            <Setter Property="Width" Value="48" />
            <Setter Property="Height" Value="24" />
            <Setter Property="Margin" Value="8,0,0,0" />
        </Style>
    </UserControl.Resources>

    <Grid Margin="0,0,16,12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,16,0,24">
            <TextBlock Text="{Binding PageTitle}"
                       FontSize="22"
                       FontWeight="Medium"
                       Foreground="{DynamicResource TextFillColorPrimaryBrush}" />
            <TextBlock Text="{Binding PageDescription}"
                       Margin="0,4,0,0"
                       FontSize="14"
                       Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
        </StackPanel>

        <!-- System Optimizations -->
        <Border Grid.Row="1" Style="{StaticResource SettingsCardStyle}">
            <StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                    <wpfui:SymbolIcon Symbol="Settings24"
                                       FontSize="20"
                                       Margin="0,0,8,0"
                                       VerticalAlignment="Center"
                                       Foreground="{DynamicResource SystemAccentColorBrush}" />
                    <TextBlock Text="{x:Static resources:Resource.SystemOptimizations_Title}"
                               Style="{StaticResource SettingsHeaderStyle}" />
                </StackPanel>

                <Grid Margin="0,4">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="{x:Static resources:Resource.ContextMenuAnimations_Title}" FontWeight="Medium" />
                        <TextBlock Text="{x:Static resources:Resource.ContextMenuAnimations_Description}" FontSize="12" Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
                    </StackPanel>
                    <ToggleButton Grid.Column="1" IsChecked="{Binding ContextMenuAnimations}" Style="{StaticResource ToggleStyle}" />
                </Grid>

                <Grid Margin="0,4">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="{x:Static resources:Resource.ShowFileExtensions_Title}" FontWeight="Medium" />
                        <TextBlock Text="{x:Static resources:Resource.ShowFileExtensions_Description}" FontSize="12" Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
                    </StackPanel>
                    <ToggleButton Grid.Column="1" IsChecked="{Binding ShowFileExtensions}" Style="{StaticResource ToggleStyle}" />
                </Grid>

                <Grid Margin="0,4">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="{x:Static resources:Resource.ShowHiddenFiles_Title}" FontWeight="Medium" />
                        <TextBlock Text="{x:Static resources:Resource.ShowHiddenFiles_Description}" FontSize="12" Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
                    </StackPanel>
                    <ToggleButton Grid.Column="1" IsChecked="{Binding ShowHiddenFiles}" Style="{StaticResource ToggleStyle}" />
                </Grid>

                <Grid Margin="0,4">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="{x:Static resources:Resource.QuickAccess_Title}" FontWeight="Medium" />
                        <TextBlock Text="{x:Static resources:Resource.QuickAccess_Description}" FontSize="12" Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
                    </StackPanel>
                    <ToggleButton Grid.Column="1" IsChecked="{Binding QuickAccess}" Style="{StaticResource ToggleStyle}" />
                </Grid>

                <Grid Margin="0,4">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="{x:Static resources:Resource.PreviewPane_Title}" FontWeight="Medium" />
                        <TextBlock Text="{x:Static resources:Resource.PreviewPane_Description}" FontSize="12" Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
                    </StackPanel>
                    <ToggleButton Grid.Column="1" IsChecked="{Binding PreviewPane}" Style="{StaticResource ToggleStyle}" />
                </Grid>

                <Grid Margin="0,4">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="{x:Static resources:Resource.Transparency_Title}" FontWeight="Medium" />
                        <TextBlock Text="{x:Static resources:Resource.Transparency_Description}" FontSize="12" Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
                    </StackPanel>
                    <ToggleButton Grid.Column="1" IsChecked="{Binding Transparency}" Style="{StaticResource ToggleStyle}" />
                </Grid>

                <Grid Margin="0,4">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="{x:Static resources:Resource.RoundedCorners_Title}" FontWeight="Medium" />
                        <TextBlock Text="{x:Static resources:Resource.RoundedCorners_Description}" FontSize="12" Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
                    </StackPanel>
                    <ToggleButton Grid.Column="1" IsChecked="{Binding RoundedCorners}" Style="{StaticResource ToggleStyle}" />
                </Grid>

                <Grid Margin="0,4">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="{x:Static resources:Resource.Shadows_Title}" FontWeight="Medium" />
                        <TextBlock Text="{x:Static resources:Resource.Shadows_Description}" FontSize="12" Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
                    </StackPanel>
                    <ToggleButton Grid.Column="1" IsChecked="{Binding Shadows}" Style="{StaticResource ToggleStyle}" />
                </Grid>
            </StackPanel>
        </Border>

        <!-- Context Menu Items -->
        <Border Grid.Row="2" Style="{StaticResource SettingsCardStyle}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <!-- Header -->
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,12">
                    <wpfui:SymbolIcon Symbol="List24"
                                       FontSize="20"
                                       Margin="0,0,8,0"
                                       VerticalAlignment="Center"
                                       Foreground="{DynamicResource SystemAccentColorBrush}" />
                    <TextBlock Text="{x:Static resources:Resource.ContextMenuItems_Title}"
                               Style="{StaticResource SettingsHeaderStyle}" />
                    <wpfui:Button Content="{x:Static resources:Resource.ResetToDefaults_Button}"
                             Click="ResetMenuItems_Click"
                             Appearance="Secondary"
                             Height="32"
                             Width="140"
                             Margin="16,0,0,0"
                             HorizontalAlignment="Left" />
                    <wpfui:Button Content="{x:Static resources:Resource.Refresh_Button}"
                             Click="RefreshButton_Click"
                             Appearance="Secondary"
                             Height="32"
                             Width="80"
                             Margin="8,0,0,0"
                             HorizontalAlignment="Left" />
                </StackPanel>

                <!-- Column Headers -->
                <Grid Grid.Row="1" Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock Grid.Column="0" Text="{x:Static resources:Resource.Name_Column}" FontWeight="Medium" />
                    <TextBlock Grid.Column="1" Text="{x:Static resources:Resource.Category_Column}" FontWeight="Medium" />
                    <TextBlock Grid.Column="2" Text="{x:Static resources:Resource.Command_Column}" FontWeight="Medium" />
                    <TextBlock Grid.Column="3" Text="{x:Static resources:Resource.Status_Column}" FontWeight="Medium" HorizontalAlignment="Center" />
                </Grid>

                <!-- Menu Items List -->
                <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto" MaxHeight="300">
                    <ItemsControl ItemsSource="{Binding MenuItems}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Style="{StaticResource ListItemStyle}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="2*" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        
                                        <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                            <TextBlock Text="{Binding Name}" FontWeight="Medium" />
                                            <TextBlock Text="{Binding Description}" 
                                                       FontSize="12"
                                                       Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
                                        </StackPanel>
                                        
                                        <TextBlock Grid.Column="1" 
                                                   Text="{Binding Category}"
                                                   VerticalAlignment="Center"
                                                   Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
                                        
                                        <TextBlock Grid.Column="2" 
                                                   Text="{Binding Command}"
                                                   VerticalAlignment="Center"
                                                   Foreground="{DynamicResource TextFillColorTertiaryBrush}"
                                                   FontSize="12" />
                                        
                                        <ToggleButton Grid.Column="3"
                                                     IsChecked="{Binding IsEnabled}"
                                                     Click="ToggleMenuItem_Click"
                                                     Tag="{Binding Id}"
                                                     Style="{StaticResource ToggleStyle}"
                                                     HorizontalAlignment="Center" />
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
            </Grid>
        </Border>

        <!-- Shell Extensions -->
        <Border Grid.Row="2" Style="{StaticResource SettingsCardStyle}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <!-- Header -->
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,12">
                    <wpfui:SymbolIcon Symbol="AppFolder24"
                                       FontSize="20"
                                       Margin="0,0,8,0"
                                       VerticalAlignment="Center"
                                       Foreground="{DynamicResource SystemAccentColorBrush}" />
                    <TextBlock Text="{x:Static resources:Resource.ShellExtensions_Title}"
                               Style="{StaticResource SettingsHeaderStyle}" />
                </StackPanel>

                <!-- Column Headers -->
                <Grid Grid.Row="1" Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock Grid.Column="0" Text="{x:Static resources:Resource.Name_Column}" FontWeight="Medium" />
                    <TextBlock Grid.Column="1" Text="{x:Static resources:Resource.Type_Column}" FontWeight="Medium" />
                    <TextBlock Grid.Column="2" Text="{x:Static resources:Resource.Version_Column}" FontWeight="Medium" />
                    <TextBlock Grid.Column="3" Text="{x:Static resources:Resource.System_Column}" FontWeight="Medium" HorizontalAlignment="Center" />
                    <TextBlock Grid.Column="4" Text="{x:Static resources:Resource.Status_Column}" FontWeight="Medium" HorizontalAlignment="Center" />
                </Grid>
                
                <!-- Extensions List -->
                <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto" MaxHeight="300">
                    <ItemsControl ItemsSource="{Binding Extensions}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Style="{StaticResource ListItemStyle}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="2*" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        
                                        <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                            <TextBlock Text="{Binding Name}" FontWeight="Medium" />
                                            <TextBlock Text="{Binding Description}" 
                                                       FontSize="12"
                                                       Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
                                        </StackPanel>
                                        
                                        <TextBlock Grid.Column="1" 
                                                   Text="{Binding Type}"
                                                   VerticalAlignment="Center"
                                                   Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
                                        
                                        <TextBlock Grid.Column="2" 
                                                   Text="{Binding Version}"
                                                   VerticalAlignment="Center"
                                                   Foreground="{DynamicResource TextFillColorTertiaryBrush}"
                                                   FontSize="12" />
                                        
                                        <TextBlock Grid.Column="3" 
                                                   Text="{Binding IsSystem, Converter={StaticResource BooleanToYesNoConverter}}"
                                                   VerticalAlignment="Center"
                                                   HorizontalAlignment="Center"
                                                   Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
                                        
                                        <ToggleButton Grid.Column="4"
                                                     IsChecked="{Binding IsEnabled}"
                                                     IsEnabled="{Binding IsSystem, Converter={StaticResource InverseBooleanConverter}}"
                                                     Click="ToggleExtension_Click"
                                                     Tag="{Binding Id}"
                                                     Style="{StaticResource ToggleStyle}"
                                                     HorizontalAlignment="Center" />
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
            </Grid>
        </Border>
    </Grid>
</UserControl>