<Page x:Class="LenovoLegionToolkit.Plugins.ShellIntegration.ShellIntegrationPage"
               xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
               xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
               xmlns:wpfui="http://schemas.lepo.co/wpfui/2022/xaml"
               xmlns:utils="clr-namespace:LenovoLegionToolkit.WPF.Utils"
                FlowDirection="LeftToRight">

    <Page.Resources>
        <!-- Card Style -->
        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="{DynamicResource ControlFillColorDefaultBrush}" />
            <Setter Property="BorderBrush" Value="{DynamicResource ControlStrokeColorDefaultBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="8" />
            <Setter Property="Padding" Value="24" />
            <Setter Property="Margin" Value="0,0,0,16" />
        </Style>
        
        <!-- Header Style -->
        <Style x:Key="HeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="18" />
            <Setter Property="FontWeight" Value="Medium" />
            <Setter Property="Foreground" Value="{DynamicResource TextFillColorPrimaryBrush}" />
            <Setter Property="Margin" Value="0,0,0,8" />
        </Style>
        
        <!-- Status Badge Style -->
        <Style x:Key="StatusBadgeStyle" TargetType="Border">
            <Setter Property="Padding" Value="12,6" />
            <Setter Property="CornerRadius" Value="16" />
            <Setter Property="Margin" Value="8,0" />
        </Style>
        
        <!-- Status Text Style -->
        <Style x:Key="StatusTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12" />
            <Setter Property="FontWeight" Value="Medium" />
            <Setter Property="Foreground" Value="{DynamicResource TextOnAccentFillColorPrimaryBrush}" />
        </Style>
        
        <!-- Action Button Style -->
        <Style x:Key="ActionButtonStyle" TargetType="wpfui:Button">
            <Setter Property="Height" Value="36" />
            <Setter Property="MinWidth" Value="120" />
            <Setter Property="Margin" Value="8,0,8,0" />
        </Style>
        
        <!-- Progress Bar Style -->
        <Style x:Key="CompactProgressBar" TargetType="ProgressBar">
            <Setter Property="Height" Value="4" />
            <Setter Property="Margin" Value="8,8,0,0" />
            <Setter Property="Visibility" Value="Collapsed" />
        </Style>
    </Page.Resources>

    <Grid Margin="0,0,16,12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,16,0,24">
            <TextBlock Text="{Binding PageTitle}"
                       FontSize="24"
                       FontWeight="Medium"
                       Foreground="{DynamicResource TextFillColorPrimaryBrush}" />
            <TextBlock Text="{Binding PageDescription}"
                       Margin="0,8,0,0"
                       FontSize="14"
                       Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
        </StackPanel>

        <!-- Status Card -->
        <Border Grid.Row="1" Style="{StaticResource CardStyle}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <!-- Header -->
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,16">
                    <wpfui:SymbolIcon Symbol="Shield24"
                                       FontSize="24"
                                       Margin="0,0,8,0"
                                       VerticalAlignment="Center"
                                       Foreground="{DynamicResource SystemAccentColorBrush}" />
                    <TextBlock Text="Service Status"
                               Style="{StaticResource HeaderStyle}" />
                </StackPanel>

                <!-- Status Information -->
                <Grid Grid.Row="1" Margin="0,0,0,16">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    
                    <StackPanel Grid.Column="0" Orientation="Vertical">
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                            <TextBlock Text="Installation: " FontWeight="Medium" />
                            <Border Style="{StaticResource StatusBadgeStyle}"
                                     Background="{Binding IsInstalled, Converter={StaticResource BooleanToAccentBrushConverter}}">
                                <TextBlock Text="{Binding IsInstalled, Converter={StaticResource BooleanToInstallationStatusConverter}}"
                                           Style="{StaticResource StatusTextStyle}" />
                            </Border>
                        </StackPanel>
                        
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                            <TextBlock Text="Service: " FontWeight="Medium" />
                            <Border Style="{StaticResource StatusBadgeStyle}"
                                     Background="{Binding IsRunning, Converter={StaticResource BooleanToRunningStatusBrushConverter}}">
                                <TextBlock Text="{Binding Status}"
                                           Style="{StaticResource StatusTextStyle}" />
                            </Border>
                        </StackPanel>
                        
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Version: " FontWeight="Medium" />
                            <TextBlock Text="{Binding Version}" 
                                       Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
                        </StackPanel>
                    </StackPanel>
                    
                    <Button Grid.Column="1" 
                            Content="Refresh"
                            Click="RefreshButton_Click"
                            Height="32"
                            Width="80" />
                </Grid>

                <!-- Action Buttons -->
                <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,0,0,8">
                    <wpfui:Button x:Name="InstallButton"
                                   Content="Install"
                                   Icon="Add24"
                                   Appearance="Primary"
                                   Click="InstallButton_Click"
                                   Style="{StaticResource ActionButtonStyle}" />

                    <wpfui:Button x:Name="UninstallButton"
                                   Content="Uninstall"
                                   Icon="Delete24"
                                   Appearance="Danger"
                                   Click="UninstallButton_Click"
                                   Style="{StaticResource ActionButtonStyle}" />
                    
                    <wpfui:Button x:Name="StartButton"
                                   Content="Start"
                                   Icon="Play24"
                                   Appearance="Success"
                                   Click="StartButton_Click"
                                   Style="{StaticResource ActionButtonStyle}" />
                    
                    <wpfui:Button x:Name="StopButton"
                                   Content="Stop"
                                   Icon="Pause24"
                                   Appearance="Caution"
                                   Click="StopButton_Click"
                                   Style="{StaticResource ActionButtonStyle}" />
                </StackPanel>

                <!-- Progress Bars -->
                <ProgressBar x:Name="InstallProgressBar"
                             Grid.Row="3"
                             Style="{StaticResource CompactProgressBar}" />
                <ProgressBar x:Name="UninstallProgressBar"
                             Grid.Row="3"
                             Style="{StaticResource CompactProgressBar}" />
                <ProgressBar x:Name="StartProgressBar"
                             Grid.Row="3"
                             Style="{StaticResource CompactProgressBar}" />
                <ProgressBar x:Name="StopProgressBar"
                             Grid.Row="3"
                             Style="{StaticResource CompactProgressBar}" />
            </Grid>
        </Border>

        <!-- Quick Actions Card -->
        <Border Grid.Row="2" Style="{StaticResource CardStyle}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <!-- Header -->
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,16">
                    <wpfui:SymbolIcon Symbol="Settings24"
                                       FontSize="24"
                                       Margin="0,0,8,0"
                                       VerticalAlignment="Center"
                                       Foreground="{DynamicResource SystemAccentColorBrush}" />
                    <TextBlock Text="Quick Actions"
                               Style="{StaticResource HeaderStyle}" />
                </StackPanel>

                <!-- Action Buttons -->
                <StackPanel Grid.Row="1" Orientation="Horizontal">
                    <Button Content="Menu Settings"
                            Click="MenuSettingsButton_Click"
                            Height="36"
                            Width="140"
                            Margin="0,0,16,0"
                            ToolTip="Configure context menu items" />
                     
                    <Button Content="Extension Settings"
                            Click="ExtensionSettingsButton_Click"
                            Height="36"
                            Width="160"
                            ToolTip="Manage shell extensions" />
                </StackPanel>
            </Grid>
        </Border>

        <!-- Information Card -->
        <Border Grid.Row="3" Style="{StaticResource CardStyle}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <!-- Header -->
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,16">
                    <wpfui:SymbolIcon Symbol="Info24"
                                       FontSize="24"
                                       Margin="0,0,8,0"
                                       VerticalAlignment="Center"
                                       Foreground="{DynamicResource SystemAccentColorBrush}" />
                    <TextBlock Text="About Shell Integration"
                               Style="{StaticResource HeaderStyle}" />
                </StackPanel>

                <!-- Information Content -->
                <StackPanel Grid.Row="1">
                    <TextBlock Text="Shell Integration provides enhanced Windows context menu functionality with:"
                               FontSize="14"
                               Margin="0,0,0,12" />
                    
                    <StackPanel Margin="16,0,0,0">
                        <TextBlock Text="• Custom context menu items"
                                   FontSize="13"
                                   Margin="0,0,0,4" />
                        <TextBlock Text="• Quick file operations"
                                   FontSize="13"
                                   Margin="0,0,0,4" />
                        <TextBlock Text="• Enhanced navigation options"
                                   FontSize="13"
                                   Margin="0,0,0,4" />
                        <TextBlock Text="• Integration with system tools"
                                   FontSize="13"
                                   Margin="0,0,0,4" />
                        <TextBlock Text="• Configurable menu items and extensions"
                                   FontSize="13" />
                    </StackPanel>
                    
                    <TextBlock Margin="0,16,0,0"
                               FontSize="12"
                               FontStyle="Italic"
                               Foreground="{DynamicResource TextFillColorTertiaryBrush}">
                        Note: Some features may require administrator privileges to function properly.
                    </TextBlock>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Page>